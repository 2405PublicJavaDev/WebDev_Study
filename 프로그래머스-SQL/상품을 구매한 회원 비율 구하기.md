# 상품을 구매한 회원 비율 구하기

## 문서 관리자

조승효(문서 생성자)

## 문제 풀이

join 과 서브쿼리를 적절히 활용하자

## 정답 쿼리(Oracle)

```sql
-- 코드를 입력하세요
SELECT
EXTRACT(YEAR FROM SALES_DATE) "YEAR",
EXTRACT(MONTH FROM SALES_DATE) "MONTH",
COUNT(DISTINCT(USER_ID)) "PURCHASED_USERS",
ROUND(COUNT(DISTINCT(USER_ID)) / (SELECT COUNT(USER_ID) FROM USER_INFO WHERE EXTRACT(YEAR FROM JOINED) = 2021),1) "PUCHASED_RATIO"
FROM USER_INFO
JOIN ONLINE_SALE USING(USER_ID)
WHERE EXTRACT(YEAR FROM JOINED)=2021
GROUP BY EXTRACT(YEAR FROM SALES_DATE), EXTRACT(MONTH FROM SALES_DATE)
ORDER BY 1 ASC, 2 ASC;
```

## 문제 링크

https://school.programmers.co.kr/learn/courses/30/lessons/131534
