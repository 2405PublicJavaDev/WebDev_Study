# 비디오 스트리밍과 컨텐츠 분배 네트워크
## 문서 관리자
조승효(문서 생성자)
## 인터넷 비디오
   - 녹화된 비디오는 서버에 저장되어 사용자가 비디오 시청을 서버에게 온디맨드(on-demand)로 요청한다. 넷플릭스, 유튜브(구글), 아마존, 유쿠(Youku) 등 많은 인터넷 회사가 비디오 스트리밍을 지원하고 있다.
   - 비디오는 이미지의 연속으로서 일반적으로 초당 24개 또는 30개의 이미지로 일정한 속도로 표시된다. 압축되지 않은 디지털 인코딩된 이미지는 픽셀 단위로 구성되며, 각 픽셀은 휘도와 색상을 나타내는 여러 비트들로 인코딩된다. 비디오의 중요한 특징은 압축될 수 있다는 것인데, 비디오 품질과 비트 전송률은 서로 반비례한다(trading off)
   - 네트워킹 측면에서 비디오의 가장 두드러진 특성은 높은 비트 전송률이다. 압축된 인터넷 비디오는 일반적으로 고화질 동영상을 스트리밍하기 위해 100kbps에서 3Mbps 이상으로 구서된다.
   - 연속 재생을 위해, 네트워크는 압축된 비디오의 전송률 이상의 스트리밍 애플리케이션에 대한 평균 처리량을 제공해야 한다.
   - 압축을 사용하여 동일한 비디오를 여러 버전의 품질로 만들 수 있다.
## HTTP 스트리밍 및 대쉬(DASH)
   - HTTP 스트리밍에서 비디오는 HTTP 서버 내의 특징 URL을 갖는 일반적인 파일로 저장된다.
   - 버퍼의 바이트 수가 미리 정해진 임계값(Threshold)을 초과하면 클라이언트 애플리케이션에 재생을 시작한다.
   - HTTP 스트리밍은 유튜브 등 많은 시스템에서 실제 적용되고 있으나, 중요한 문제점을 가지고 있다. 그것은 모든 클라이언트들이 그들 사이의 가용 대역폭의 차이에도 불구하고 똑같이 인코딩된 비디오를 전송받는다는 것이다. 가용 대역폭의 차이는 서로 다른 클라이언트들 간에 존재할 뿐만 아니라 동일한 클라이언트에서도 시간에 따른 차이가 발생한다. 이 문제점으로 인해 새로운 형태의 HTTP 기반 스트리밍인 DASH (Dynamic Adaptive Streaming over HTTP)가 개발되었다.
   - DASH에서 비디오는 여러 개의 서로 다른 버전으로 인코딩되며, 각 버전은 서로 다른 비트율과 품질을 가지고 있다.
   - DASH는 서로 다른 인터넷 접속회선을 가진 클라이언트들에게 서로 다른 인코딩률을 갖는 비디오를 선택할 수 있도록 허용한다.
   - DASH를 사용할 때, 각 비디오 버전은 HTTP 서버에 서로 다른 URL을 가지고 저장된다. HTTP 서버는 비트율에 따른 각 버전의 URL을 제공하는 매니패스트(manifest)파일을 가지고 있다.
## 콘텐츠 분배 네트워크(CDN)
   - 스트리밍 트래픽을 전 세계에 걸친 지점에 끊김 없이 안정적으로 제공하는 일은 매우 큰 문제다.
   - 대부분의 비디오 스트리밍 회사들은 콘텐츠 분배 네트워크(Contents Distribution Network, CDN)를 이용한다.
   - CDN은 다수의 지점에 분산된 서버들을 운영하며, 비디오 및 다른 형태의 웹 콘턴츠 데이터의 복사본을 이들 분산 서버에 저장한다.
   - 사용자는 최선의 서비스와 사용자경험(user experience)을 제공할 수 있는 지점의 CDN 서버로 연결된다.
   - CDN 은 콘텐츠 제공자가 소유한 사설 CDN일 수 있으며, 예를 들어 유튜브의 비디오는 구글의 CDN을 통해 분배된다.
   - 제3자가 운영하는 CDN을 통해 다수의 콘텐츠 제공자가 서비슿할 수도 있다.
   - Enter Depp: 서버 클러스터를 세계 곳곳의 접속 네트워크에 구축함으로써 ISP의 접속 네트워크로 깊숙이 들어가는 것이다. 이 방식의 목적은 서버를 최대한 사용자 가까이에 위치시켜 사용자와 CDN 서버 사이의 링크 및 라우터 수를 줄이고, 사용자가 경험하는 지연시간 및 처리율을 향상시키는 것이다. 문제는 고도로 분산된 설계로 인해 서버 클러스터를 유지 관리하는 비용이 커진다는 점이다.
   - Bring Home: 보다 적은 수의 핵심 지점에 큰 규모의 서버 클러스터를 구축하여 ISP를 Home으로 가져오는 개념이다. 일반적으로 IXP 에 배치된다. 유지 및 관리 비용이 줄어드는 대신에 사용자가 느끼는 지연시간과 처리율은 상대적으로 나빠진다.
   - CDN은 클러스터에 대해 Push 방식이 아닌 Pull 방식을 사용한다. 어떤 사용자가 지역 클러스터에 없는 비디오를 요청하면, 해당 비디오를 중앙 서버나 다른 클러스터로부터 전송받아 사용자에게 서비스하는 동시에 복사본을 만들어 저장한다.
### CDN 동작
   - 요청을 가로 채서 그 시점에서 클라이언트에게 가장 적당한 CDN 클러스터를 선택한다.
   - 클라이언트의 요청을 해당 클러스터의 서버로 연결한다.
   - 요청을 가로챌 때 대부분의 CDN은 사용자의 요청을 가로채고 다른 곳으로 연결하는 데 DNS를 활용한다.
### 클러스터 선택 정책
   - 클라이언트를 동적으로 어떤 서버 클러스터 또는 CDN 데이터 센터로 연결하는 방식이다.
   - CDN은 클라이언트가 DNS 서비스를 수행하는 과정에서 클라이언트의 LDNS 서버의 IP 주소를 알게 된다.
   - IP 주소를 알아낸 CDN은 해당 IP 주소에 기초해 최선의 클러스터를 선택할 필요가 있다.
   - 가장 간단한 클러스터 정책의 하나로 클라이언트에게 지리적으로 가장 가까운 클러스터를 할당하는 기법이 있다. LDNS에서 가장 가까운것 선택
   - 현재의 네트워크 트래픽 상황을 반영한 최선의 클러스터를 선택하기 위해 CDN은 주기적으로 클러스터와 클라이언트 간의 지연 및 손실 성능에 대한 실시간 측정을 수행하기도 한다.